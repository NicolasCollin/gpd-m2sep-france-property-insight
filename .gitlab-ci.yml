stages:
  - lint

lint:
  stage: lint
  image: python:3.13-slim
  # keeps the UV cache between jobs
  cache:
    key: "uv-cache"
    paths:
      - .uv-cache
  variables:
    UV_CACHE_DIR: .uv-cache
  before_script:
    - pip install --upgrade pip
    - pip install uv
    - uv tool install pre-commit ruff mypy pip-audit pytest
  script:
    - uv run pre-commit run --all-files --show-diff-on-failure
    - uv run mypy . #typecheck
    - uv run pip-audit . #scan for vulnerable dependencies
    - uv run python -m pytest --doctest-modules --maxfail=3 --disable-warnings -q
